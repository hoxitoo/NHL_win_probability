# Модель вероятности победы в матчах НХЛ (с учётом ОТ и буллитов)

Этот проект представляет собой **аналитическую модель для оценки вероятности победы команд НХЛ**,  
включая **овертайм и серию буллитов**.

Модель использует:
- исторические данные НХЛ (текущий сезон + 2 предыдущих),
- силу команды на основе **вклада игроков**,
- **форму вратарей** и определение вероятного стартера,
- методы **машинного обучения** (Logistic Regression).

Результат работы модели:
- **вероятность победы (%)**
- **честный коэффициент**, рассчитанный как `1 / вероятность`

---

## Цели проекта

- Оценивать вероятность победы команды **до начала матча**
- Учитывать:
  - изменения в составах
  - сохранение «ядра» команды
  - влияние стартового вратаря
- Сравнивать коэффициенты модели с линией букмекеров
- Построить прозрачную и интерпретируемую ML-модель

---

## Источники данных

- **NHL Web API**
  - расписание матчей
  - результаты игр
  - детальная статистика boxscore (игроки и вратари)

Покрытие данных:
- текущий сезон НХЛ
- два предыдущих сезона НХЛ

Boxscore-данные кэшируются локально для ускорения повторных запусков.

---

## Генерация признаков (Feature Engineering)

### Сила команды (полевые игроки)
Рассчитывается как средний вклад всех полевых игроков команды  
за последние **N матчей**, с учётом:
- голов
- передач
- бросков
- силовых приёмов
- блокированных бросков
- штрафного времени (отрицательный вклад)
- времени на льду (взвешивание по TOI)

---

### Форма вратаря
- определяется **вероятный стартовый вратарь**
- оценивается его текущая форма по последним матчам:
  - процент отражённых бросков (SV%)
  - игровая нагрузка (время на льду)

---

### Признаки матча
Для каждого матча используются:
- разница силы полевых игроков (хозяева − гости)
- разница формы вратарей (хозяева − гости)

---

## Модель

- **Логистическая регрессия (Logistic Regression)**
- Целевая переменная:
  - победа хозяев с учётом овертайма и буллитов
- Числовые признаки нормализуются
- Обучение выполняется **без утечки данных во времени**

---

## Пример результата

Вероятность победы хозяев: 60.0%
Честный коэффициент: 1.67
